{"version":3,"sources":["components/AppMenu.js","helpers/webNotification.js","socket.controller.js","components/LeftSidebar.js"],"names":["MenuItemWithChildren","item","linkClassNames","subMenuClassNames","activatedMenuItemIds","Icon","icon","className","classNames","indexOf","id","to","aria-expanded","badge","variant","text","name","children","map","child","i","Fragment","key","active","MenuItem","linkClassName","MenuItemLink","path","AppMenu","componentDidMount","props","menu","menuItems","initMenu","history","listen","location","action","changeActiveMenuFromLocation","componentDidUpdate","prevProps","this","mode","menuRef","MetisMenu","on","event","window","addEventListener","menuClick","e","target","contains","hide","detail","shownElement","removeEventListener","isHorizontal","activatedKeys","RoomList","currentRoom","roles","includes","role","header","Component","defaultProps","withRouter","connect","state","exports","showNotification","title","content","Notification","body","dir","timestamp","MySocket","socket","dispatch","user","addToast","console","log","emit","accessToken","data","df","getRoomCookieDefault","room","_id","getCubeDataSuccess","getSensorData","getCurrentDataSuccess","getAreaDataSuccess","message","pushNotification","permission","appearance","autoDismiss","updateNotification","access","BASE_URL","require","io","UserProfile","useDispatch","useToasts","React","useEffect","getRoomList","getNotificationList","src","avatar","alt","username","fullname","UncontrolledDropdown","DropdownToggle","data-toggle","tag","DropdownMenu","right","DropdownItem","divider","SideNav","LeftSidebar","document","handleOtherClick","componentWillUnmount","menuNodeRef","isMobileOnly","classList","remove","handleClick","bind","isCondensed","ref","node","Auth","loading","error"],"mappings":"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","file":"static/js/28.c6e4aee4.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { Link, withRouter } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\nimport classNames from 'classnames';\r\nimport MetisMenu from 'metismenujs/dist/metismenujs';\r\n\r\nimport { initMenu, changeActiveMenuFromLocation } from '../redux/actions';\r\n\r\n\r\nconst MenuItemWithChildren = ({ item, linkClassNames, subMenuClassNames, activatedMenuItemIds }) => {\r\n    const Icon = item.icon || null;\r\n    return (\r\n        <li className={classNames('side-nav-item', { 'active mm-active': activatedMenuItemIds.indexOf(item.id) >= 0 })}>\r\n            <Link\r\n                to=\"/\"\r\n                className={classNames('side-sub-nav-link', linkClassNames)}\r\n                aria-expanded={activatedMenuItemIds.indexOf(item.id) >= 0}>\r\n                {item.icon && <Icon />}\r\n                {item.badge && (\r\n                    <span className={`badge badge-${item.badge.variant} float-right`}>{item.badge.text}</span>\r\n                )}\r\n                <span> {item.name} </span>\r\n                <span className=\"menu-arrow\"></span>\r\n            </Link>\r\n\r\n            <ul\r\n                className={classNames(subMenuClassNames, {\r\n                    'mm-collapse mm-show': activatedMenuItemIds.indexOf(item.id) >= 0,\r\n                })}\r\n                aria-expanded={activatedMenuItemIds.indexOf(item.id) >= 0}>\r\n                {item.children.map((child, i) => {\r\n                    return (\r\n                        <React.Fragment key={i}>\r\n                            {child.children ? (\r\n                                <MenuItemWithChildren\r\n                                    item={child}\r\n                                    linkClassNames={classNames({ active: activatedMenuItemIds.indexOf(child.id) >= 0 })}\r\n                                    activatedMenuItemIds={activatedMenuItemIds}\r\n                                    subMenuClassNames=\"side-nav-third-level\"\r\n                                />\r\n                            ) : (\r\n                                    <MenuItem\r\n                                        item={child}\r\n                                        className={classNames({ active: activatedMenuItemIds.indexOf(child.id) >= 0 })}\r\n                                        linkClassName={classNames({ active: activatedMenuItemIds.indexOf(child.id) >= 0 })}\r\n                                    />\r\n                                )}\r\n                        </React.Fragment>\r\n                    );\r\n                })}\r\n            </ul>\r\n        </li>\r\n    );\r\n};\r\n\r\nconst MenuItem = ({ item, className, linkClassName }) => {\r\n    return (\r\n        <li className={classNames('side-nav-item', className)}>\r\n            <MenuItemLink item={item} className={linkClassName} />\r\n        </li>\r\n    );\r\n};\r\n\r\nconst MenuItemLink = ({ item, className }) => {\r\n    const Icon = item.icon || null;\r\n    return (\r\n        <Link to={item.path} className={classNames('side-nav-link-ref', 'side-sub-nav-link', className)}>\r\n            {item.icon && <Icon />}\r\n            {item.badge && <span className={`font-size-12 badge badge-${item.badge.variant} float-right`}>{item.badge.text}</span>}\r\n            <span> {item.name} </span>\r\n        </Link>\r\n    );\r\n};\r\n\r\n/**\r\n * Renders the application menu\r\n */\r\n\r\nclass AppMenu extends Component {\r\n    static defaultProps = {\r\n        mode: 'vertical',\r\n    };\r\n\r\n    componentDidMount = () => {\r\n        if (!this.props.menu.menuItems) this.props.initMenu();\r\n        else this.initMenu();\r\n\r\n        this.props.history.listen((location, action) => {\r\n            this.props.changeActiveMenuFromLocation();\r\n        });\r\n    };\r\n\r\n    componentDidUpdate = prevProps => {\r\n        if (\r\n            !prevProps.menu.menuItems ||\r\n            (prevProps.menu.menuItems && prevProps.menu.menuItems !== this.props.menu.menuItems)\r\n        ) {\r\n            this.initMenu();\r\n        }\r\n\r\n        if (!this.props.menu.activatedMenuItemIds) {\r\n            this.props.changeActiveMenuFromLocation();\r\n        }\r\n    };\r\n\r\n    initMenu() {\r\n        if (this.props.mode === 'horizontal') {\r\n            const menuRef = new MetisMenu('#menu-bar').on('shown.metisMenu', function (event) {\r\n                window.addEventListener('click', function menuClick(e) {\r\n                    if (!event.target.contains(e.target)) {\r\n                        menuRef.hide(event.detail.shownElement);\r\n                        window.removeEventListener('click', menuClick);\r\n                    }\r\n                });\r\n            });\r\n        } else {\r\n            new MetisMenu('#menu-bar');\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const isHorizontal = this.props.mode === 'horizontal';\r\n        const activatedKeys = isHorizontal ? [] : this.props.menu ? (this.props.menu.activatedMenuItemIds? this.props.menu.activatedMenuItemIds :[]) : [] || [];\r\n\r\n        return (\r\n            <React.Fragment>\r\n                \r\n                        {this.props.menu && this.props.menu.menuItems &&  (\r\n                            <ul className=\"metismenu\" id=\"menu-bar\">\r\n                                {this.props.menu.menuItems.map((item, i) => {\r\n                                    if(this.props.RoomList.currentRoom)\r\n                                        if(item.roles.includes(this.props.RoomList.currentRoom.role))\r\n                                    return (\r\n                                        <React.Fragment key={item.id}>\r\n                                            {item.header && !isHorizontal && (\r\n                                                <li className=\"menu-title\" key={i + '-el'}>\r\n                                                    {item.header}\r\n                                                </li>\r\n                                            )}\r\n\r\n                                            {item.children ? (\r\n                                                <MenuItemWithChildren\r\n                                                    item={item}\r\n                                                    subMenuClassNames=\"nav-second-level\"\r\n                                                    activatedMenuItemIds={activatedKeys}\r\n                                                    linkClassNames=\"side-nav-link\"\r\n                                                />\r\n                                            ) : (\r\n                                                    <MenuItem\r\n                                                        item={item}\r\n                                                        className={classNames({ 'mm-active': activatedKeys.indexOf(item.id) >= 0 })}\r\n                                                        linkClassName=\"side-nav-link\"\r\n                                                    />\r\n                                                )}\r\n                                        </React.Fragment>\r\n                                    );\r\n                                })}\r\n                            </ul>\r\n                        )}\r\n            </React.Fragment>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        menu: state.AppMenu,\r\n        RoomList: state.RoomList\r\n    };\r\n};\r\nexport default withRouter(\r\n    connect(\r\n        mapStateToProps,\r\n        { initMenu, changeActiveMenuFromLocation }\r\n    )(AppMenu)\r\n);\r\n","exports.showNotification= (title,content)=> {\r\n    var options = {\r\n    body: content,\r\n    icon: \"http://vikhan.tk/assets/img/logo1.png\",\r\n    dir: \"ltr\",\r\n    timestamp: 3000\r\n    };\r\n    new Notification(title, options);\r\n}","import { getRoomCookieDefault, setRoomCookieDefault } from \"helpers/roomUtils\";\r\nimport { showNotification } from \"helpers/webNotification\";\r\nimport { getAreaDataSuccess, getCubeDataSuccess, getCurrentDataSuccess, getSensorData, pushNotification, updateNotification } from \"redux/actions\";\r\n\r\nconst MySocket = (socket,dispatch,user,addToast) => {\r\n    socket.on('connect', function(){\r\n        console.log('Socket io Client',\"connect\");\r\n        socket.emit('login',user.accessToken);\r\n    });\r\n\r\n    socket.on('data_cube_room', function(data){\r\n        let df = getRoomCookieDefault()\r\n        if(df)\r\n            if(df.room._id === data.room){\r\n                dispatch(getCubeDataSuccess(data))\r\n            }   \r\n            console.log('Socket io Client Cube',data);\r\n    });\r\n\r\n    socket.on('data_room', function(data){\r\n        let df = getRoomCookieDefault()\r\n        if(df)\r\n            if(df.room._id === data.room){\r\n                dispatch(getSensorData(user,data.room));\r\n                dispatch(getCurrentDataSuccess(data))\r\n            }   \r\n            console.log('Socket io Client Curent Data',data);\r\n    });\r\n    socket.on('log', function(data){\r\n        console.log('Socket io Client Log',data);\r\n    });\r\n\r\n    socket.on('data_area',function(data){\r\n        let df = getRoomCookieDefault()\r\n        if(df)\r\n            if(df.room._id === data.room)\r\n                dispatch(getAreaDataSuccess(data));\r\n\r\n        console.log('Socket io Client Area',data);\r\n        \r\n    })\r\n    \r\n    socket.on('notification', function(data){\r\n        if(data.message =='add'){\r\n            dispatch(pushNotification(data.data));\r\n\r\n            if (Notification.permission == \"granted\"){\r\n                showNotification('Quản lý nhiệt độ kho lạnh',data.data.content);\r\n            }else{\r\n                addToast(data.data.content, {\r\n                    appearance: 'warning',\r\n                    autoDismiss: true,\r\n                });\r\n            }\r\n        }\r\n        if(data.message =='update'){\r\n            dispatch(updateNotification(data.data._id,data.data));\r\n        }\r\n        //console.log('Socket io Client Notification',data);\r\n    });\r\n\r\n\r\n  \r\n    socket.on('access', function(data){\r\n        console.log('Socket io Client',data);\r\n        if(data.message =='add'){\r\n            socket.emit('join-room', 'room'+data.data.access.room);\r\n            if (Notification.permission == \"granted\"){\r\n                showNotification('Quản lý nhiệt độ kho lạnh',data.data.content);\r\n            }else{\r\n                addToast(data.data.content, {\r\n                    appearance: 'warning',\r\n                    autoDismiss: true,\r\n                });\r\n            }\r\n        }\r\n        if(data.message =='edit'){\r\n            //do something\r\n        }\r\n        if(data.message =='delete' && data.data.access.user==user.user._id){\r\n            socket.emit('leave-room', 'room'+data.data.access.room);  \r\n        }\r\n        \r\n    });\r\n      /*\r\n\r\n\r\n    socket.on('area', function(data){\r\n        if(data.message == 'add'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n        if(data.message == 'edit'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n        if(data.message == 'delete'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n        if(data.message == 'add-monitor'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n        if(data.message == 'edit-monitor'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n        if(data.message == 'switch-monitor'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n        if(data.message == 'delete-monitor'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n    })\r\n\r\n\r\n    socket.on('activate', function(data){\r\n        if(data.message == 'add'){\r\n            console.log('Socket io Client',data); \r\n        }\r\n        if(data.message == 'delete'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n    }); */\r\n\r\n\r\n\r\n    socket.on('room', function(data){\r\n     /*    if(data.message == 'delete'){\r\n            let defaultRoom = getRoomCookieDefault();\r\n            if(defaultRoom)\r\n                if(defaultRoom.room._id === data.data.room._id){\r\n                    setRoomCookieDefault(null);\r\n                }\r\n            dispatch(getRoomList(user));\r\n            socket.emit('leave-room', 'room'+data.data.room._id); \r\n        }\r\n        if(data.message == 'edit'){\r\n            console.log('Socket io Client',data);\r\n            let defaultRoom = getRoomCookieDefault();\r\n            dispatch(getRoomList(user));\r\n            if(defaultRoom.room._id === data.data._id){\r\n                setRoomCookieDefault({...defaultRoom,room:{\r\n                    _id:    data.data._id,\r\n                    name:   data.data.name\r\n                }});\r\n                dispatch(setDefaultRoom(getRoomCookieDefault()));\r\n                dispatch(getCurrentRoomInfo(data.data._id,user.accessToken));\r\n            }\r\n        } */\r\n    });\r\n\r\n   /*  socket.on('structure', function(data){\r\n        if(data.message == 'add'){\r\n            console.log('Socket io Client',data); \r\n        }\r\n        if(data.message == 'update'){\r\n            console.log('Socket io Client',data);  \r\n        }\r\n    });\r\n */\r\n\r\n    socket.on('disconnect', function(){});\r\n}\r\n\r\nexport default MySocket;","import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\n\r\nimport { isMobileOnly } from 'react-device-detect';\r\nimport PerfectScrollbar from 'react-perfect-scrollbar';\r\nimport 'react-perfect-scrollbar/dist/css/styles.css';\r\n\r\nimport { UncontrolledDropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\r\nimport * as FeatherIcon from 'react-feather';\r\n\r\nimport AppMenu from './AppMenu';\r\nimport { useDispatch}  from 'react-redux';\r\nimport { getNotificationList, getRoomList } from 'redux/actions';\r\n/* import MySocket from 'socket.controller'; */\r\nimport { useToasts } from 'react-toast-notifications'\r\nimport MySocket from 'socket.controller';\r\nconst {BASE_URL} = require('constants/apiConfig');\r\n\r\nvar io = require('socket.io-client');\r\n/**\r\n * User Widget\r\n */\r\nconst UserProfile = (props) => {\r\n    const dispatch = useDispatch();\r\n    const { addToast } = useToasts();\r\n\r\n    React.useEffect(()=>{\r\n        if(props.user && props.user.accessToken){\r\n            dispatch(getRoomList(props.user))\r\n            dispatch(getNotificationList(props.user))\r\n            var socket = io.connect(BASE_URL);\r\n            console.log('Socket io Client','run socket client');\r\n            MySocket(socket,dispatch,props.user,addToast);\r\n        }\r\n        \r\n    },[props.user])\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <div className=\"media user-profile mt-2 mb-2\">\r\n                <img\r\n                    src={props.user.user.avatar}\r\n                    className=\"avatar-sm rounded-circle mr-2\"\r\n                    alt={props.user.user.username}\r\n                />\r\n                <img\r\n                    src={props.user.user.avatar}\r\n                    className=\"avatar-xs rounded-circle mr-2\"\r\n                    alt={props.user.user.username}\r\n                />\r\n\r\n                <div className=\"media-body\">\r\n                    <h6 className=\"pro-user-name mt-0 mb-0\">{props.user.user.fullname}</h6>\r\n                    <span className=\"pro-user-desc\">{props.user.user.username}</span>\r\n                </div>\r\n\r\n                <UncontrolledDropdown className=\"align-self-center profile-dropdown-menu\">\r\n                    <DropdownToggle\r\n                        data-toggle=\"dropdown\"\r\n                        tag=\"button\"\r\n                        className=\"btn btn-link p-0 dropdown-toggle mr-0\">\r\n                        <FeatherIcon.ChevronDown />\r\n                    </DropdownToggle>\r\n                    <DropdownMenu right className=\"topbar-dropdown-menu profile-dropdown-items\">\r\n                        <Link to=\"/account/info\" className=\"dropdown-item notify-item\">\r\n                            <FeatherIcon.User className=\"icon-dual icon-xs mr-2\" />\r\n                            <span>Tài khoản</span>\r\n                        </Link>\r\n                        <Link to=\"/account/lock\" className=\"dropdown-item notify-item\">\r\n                            <FeatherIcon.Lock className=\"icon-dual icon-xs mr-2\" />\r\n                            <span>Khóa màn hình</span>\r\n                        </Link>\r\n                        <DropdownItem divider />\r\n                        <Link to=\"/account/logout\" className=\"dropdown-item notify-item\">\r\n                            <FeatherIcon.LogOut className=\"icon-dual icon-xs mr-2\" />\r\n                            <span>Đăng xuất</span>\r\n                        </Link>\r\n                    </DropdownMenu>\r\n                </UncontrolledDropdown>\r\n            </div>\r\n        </React.Fragment>\r\n    );\r\n};\r\n\r\n/**\r\n * Sidenav\r\n */\r\nconst SideNav = () => {\r\n    return (\r\n        <div className=\"sidebar-content\">\r\n            <div id=\"sidebar-menu\">\r\n                <AppMenu />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nclass LeftSidebar extends Component {\r\n    menuNodeRef;\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.handleClick = this.handleClick.bind(this);\r\n        this.handleOtherClick = this.handleOtherClick.bind(this);\r\n    }\r\n\r\n    /**\r\n     * Bind event\r\n     */\r\n    componentDidMount = () => {\r\n        document.addEventListener('mousedown', this.handleOtherClick, false);\r\n    };\r\n\r\n    /**\r\n     * Bind event\r\n     */\r\n    componentWillUnmount = () => {\r\n        document.removeEventListener('mousedown', this.handleOtherClick, false);\r\n    };\r\n\r\n    /**\r\n     * Handle the click anywhere in doc\r\n     */\r\n    handleOtherClick = (e) => {\r\n        if (this.menuNodeRef.contains(e.target)) return;\r\n        // else hide the menubar\r\n        if (document.body && isMobileOnly) {\r\n            document.body.classList.remove('sidebar-enable');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Handle click\r\n     * @param {*} e\r\n     * @param {*} item\r\n     */\r\n    handleClick(e) {\r\n        console.log(e);\r\n    }\r\n\r\n    render() {\r\n        const isCondensed = this.props.isCondensed || false;\r\n        return (\r\n            <React.Fragment>\r\n                <div className=\"left-side-menu\" ref={(node) => (this.menuNodeRef = node)}>\r\n                    <UserProfile {...this.props} />\r\n                    {!isCondensed && (\r\n                        <PerfectScrollbar>\r\n                            <SideNav />\r\n                        </PerfectScrollbar>\r\n                    )}\r\n                    {isCondensed && <SideNav />}\r\n                </div>\r\n            </React.Fragment>\r\n        );\r\n    }\r\n}\r\nconst mapStateToProps = (state) => {\r\n    const { user, loading, error } = state.Auth;\r\n    return { user, loading, error };\r\n};\r\nexport default connect(mapStateToProps, {})(LeftSidebar);\r\n"],"sourceRoot":""}